\section{Reviewer 1}
\label{sec:reviewer_1}
\textcolor{blue}{
The authors provide a very comprehensive paper. The authors use impulse based
contact dynamics models to create a simulator that can handle contacts by
introducing an unconstrained optimization problem instead. The main
contributions of the paper are:
\begin{enumerate}
    \item an unconstrained convex scheme at the points of contact to discover
    the contact velocities and impulses that is equivalent to the constrained
    problem under certain ``tunable" assumptions.
    \item a custom solver that uses exact line search to find the optimal
    step length.
    \item An explanation of regularisation proposed by Todorov in [16], and
    a link with the friction and dissipation parameters proposed by the authors.
    \item Test cases which compare various aspects of the model with
    state-of-the-art implementations. e.g. solvers comparison with Gurobi,
    energy dissipation in various implicit and explicit discretization schemes
    etc.
\end{enumerate}
Firstly, the authors use Anitescu's convex formulation for finding the contact
impulses by maximum dissipation principle (Eq. (3)), and convert it to equivalent
primal form with velocity and impulse parameters instead of impulses (Eq. (15)).
Secondly, the authors provide a compliance based physical explanation for the
regularization used by Todorov in [16] (Section IX, Eq. (18) etc), and use this
explanation to create a mapping between the optimal impulses and velocities.
Thanks to this relation, the authors remove the cone constraints from Eq. (15),
and solve Eq. (17) instead.
}
\vspace{5mm}

\textcolor{blue}{
R1-Q1: The authors use a first order approximation of the impulse dynamics (Eq. (2))
in order to recursively solve the linearized problem around the unconstrained
position $\vf{v^*}$ (Eq. (14)). This is an interesting assumption, since the linearized
problem might not be easy to converge for a high DoF system. While the authors
provide test cases with manipulators and griper contact, it still doesn't
guarantee that the problem would still converge to a solution.}

\textbf{Please note:} previous Eqs. (2) and (14) are now Eqs. (7) and (18) in the
revised manuscript, respectively.

We hope that the reviewer finds the new organization of the contents more
pleasant to read. We believe that this new organization would hopefully help
make the overall strategy more clear. To address this particular question
directly however, we added text at the end of Section III.C. In particular, we
emphasize that our algorithm has guaranteed convergence to Eq. (18), accurate to
second order (with the time step size) to the possibly non-linear balance of
momentum in Eq. (7). The accuracy statement is made in Proposition 1 and proven
in Appendix A. Guaranteed convergence of our SAP solver to the linear
approximation in Eq. (18) is proven in Appendix E.
\vspace{5mm}

\textcolor{blue}{
R1-Q2: Could the authors discuss the effects of this linearization, and what the
worst-case situation in this setup would be. }

There is a significant amount of work on the validity of the approximation in
Eq. (18) for multibody systems with or without contact. See, for instance,
\cite{bib:potra2006linearly}. As mentioned above, we comment on the validity of
these linearizations in Section III.C. A worst-case scenario would involve large
Coriolis terms, since they are quadratic functions of the generalized
velocities. We note however that these are included in the computation of the
free motion velocities $\mf{v}^*$ when using implicit schemes in Eq. (13) (when
$\theta>0$ and $\theta_{vq}>0$).
\vspace{5mm}

\textcolor{blue}{
R1-Q3: Also, the linearization would introduce joint constraint errors the
multi-body linkages. Do the authors have a measure of their convergence? If so,
could they discuss it here please?}

We suspect there is confusion about our problem setup. In this work, we do not
use maximal coordinates and we do not model joints using constraints. We instead
describe our robot models using generalized joint coordinates. Therefore our
formulation does not introduce joint drift and no constraint
stabilization is needed. To address this directly, we explicitly stated our
choice at the beginning of Section II.
\vspace{5mm}

\textcolor{blue}{
R1-Q4: The above point is linked to the the claim of ``proven global convergence"
that the authors use in the abstract. The authors do create an unconstrained
optimization problem, but the underlined dynamics seems to be implicitly
constrained, and non-convex, for which the authors use a linearized
assumption. Thus I would be interested to understand better the claim of ``proven global
convergence".}

The claim of global convergence applies to the SAP solver: on all inputs, it
converges to the unique solution of the primal formulation (19). A precise
statement of this claim appears in Appendix E. Additionally, we highlighted
relevant text in the main body of the manuscript at the beginning of Section IV.

As we clarify in our revision (at the end of Section III.C) and in the answers
to questions Q1 and Q2 above, the relation to the original possibly non-linear
balance of momentum in Eq. (7) is given in Proposition 1. Proposition 1 states
that the linearized momentum balance in Eq. (18) is a second order approximation
of the original momentum balance in Eq. (7). The text we added at the end of
Section III.C in the revised manuscript now explicitly states these
observations.
\vspace{5mm}

\textcolor{blue}{R1-Q5: ``In addition, the linearization of the friction cone
results in a far larger problem due to the additional constraints needed to
represent the polyhedral cone." Please elaborate ``larger problems" here. Could
the authors compare this to the assumptions that they need to take for the
dynamics to work?}

\RedHighlight{TODO: move this into the novel contributions section?}
We are glad the reviewer asked this question. We do not linearize friction
cones. One of the main benefits of this formulation is that it does not
introduce new variables to handle contact constraints. Instead, it only works on
the generalized velocities of the system. In addition, since we do not linearize
contact constraints, we avoid the introduction of non-physical anisotropy. To
address this question in the manuscript, and in particular to compare against
LCP formulations, we added text in the conclusions.
\vspace{5mm}

\textcolor{blue}{R1-Q6: $\theta_q$, $\theta_v$, $\theta_{vq}$ could the authors
please provide explanations for these variables in Eq. (6).}

We thank the reviewer for this question. While reviewing the manuscript we
realized that we could perform an additional simplification thanks to this
question. While in our original version we had three theta parameters, the
revised version now only contains two parameters. We marked the relevant changes
in Section II.C. In addition, we added text at the end of Section II.C
explaining that the reason for the additional parameter ($\theta_{vq}$) is so
that we can also incorporate the popular symplectic Euler scheme. In total, our
scheme is parameterized by the ``regular" $\theta$ parameter as in the
traditional $\theta$-method and the additional $\theta_{vq}$ parameter to
support the symplectic Euler scheme. These scalar parameters are the weights
that define the time stepping scheme. We refer the reviewer to the excellent
book by
\cite{bib:hairer2008solving}
(Section II.7) for further details on this method. We marked the relevant text
explaining these parameters in the revised manuscript.
\vspace{5mm}

\textcolor{blue}{R1-Q7: Could the authors please explain the significance of
``$\vf{y}$" in equations 16 and above? Since the Projection operation ($Pf()$)
is constrained, the authors still don't have an unconstrained equation in Eq.
(17), and have an implicitly defined constraint instead. Could the authors
please justify the claim of ``unconstrained convex problem" here and comment on
the implicit nature of the constraints?}

\textbf{Please note:} previous Eqs. (16) and (17) are now Eqs. (23) and (24)
in the revised manuscript, respectively.

The primal-formulation (24) is, by definition, an unconstrained optimization
problem since the variables can assume any value. Hence, it can be solved using
gradient descent (or any other descent method). Unconstrained problems, however,
are not necessarily easy. As the reviewer points out, evaluating the objective
function of (24) ostensibly requires the implicit solution of another
optimization problem. Fortunately, analytic formulae for evaluating this
objective (and its gradient and Hessian) exist and are efficiently computable.
As in our original submission, they are provided  in Section V.A and derived in
Appendix C.
%We believe that the large reorganization of the manuscript we performed
%following the excellent suggestion by this reviewer helps to make the flow of
%the paper more clear, in particular in this regard. But let us answer the
%question directly here to help in this regard better. The reason we make the
%claim ``unconstrained convex problem" is because the projection operation
%$\vf{\gamma}=P(\vf{y})$ can be computed analytically. Let us stress this again:
%$\vf{\gamma}=P(\vf{y})$ is an algebraic function for which we provide the
%explicit functional form in Section V.A and derive in Appendix C. Yes, the
%reviewer is correct that $\vf{\gamma}=P(\vf{y})$ is the result of a constrained
%convex optimization problem (Eq. 23, Section III.B), but we use the remarkable
%observation from Todorov that this can be computed analytically, see
%introduction in Section III and details in III.B. Going back to the original
%question, the formulation in now Eq. 24 (Section III.C) is ``unconstrained"
%because we do provide algebraic expressions for each of the terms in that
%equation. Yes, now the cost is a more complex nonlinear function of the
%velocities, while in Eq. 19 the cost is simply quadratic. However, we prove the
%remarkable property that this now more complex cost still is (strongly) convex
%(Appendix B) and that it is equivalent to the constrained formulation in Eq.
%19. We find this result simply beautiful and it is definitely a cornerstone of
%our work. We are pleased that the reviewer asked about this because it's a
%point that should not be missed. We updated the text to make these observations
%clear in Section III.B and III.C. We also made a major rearrangement of now
%Section III so that the arrival of the unconstrained formulation in Eq. 24
%(Section C) is not unexpected but flows naturally from the previous sections.
\vspace{5mm}

\textcolor{blue}{R1-Q8: ``fifteen years after the introduction of these convex
approximations, robust and performant algorithms for their solution in practice
are lacking." There are already multiple simulators in practice that provide
solutions with various levels of accuracy and robustness and different
assumptions. I would suggest that authors remove this claim here, it is broad
and not supported.}

Thank you for the suggestion. We do realize that such a claim could be
understood as being applicable in a broader sense and therefore we decided to
remove it to avoid the confusion of future readers. We want, however, to share
our experience with these algorithms and decided to cite the very extensive
study performed by \cite{bib:acary2018solving} (text added in Section I.B). This
study shows that even though there are good solution alternatives, most
numerical methods aimed at solving the convex approximation of contact suffer
from robustness and accuracy issues. We tried many of these algorithms ourselves
and had the same experience. This is one of the reasons that inspired our
research in this direction and that finally led to this paper. We hope this new
reference helps the reviewer understand the purpose of our research efforts.
\vspace{5mm}

\textcolor{blue}{R1-Q9: ``It is not yet clear if these formulations present a real
advantage when compared to more traditional approaches and whether the artifacts
introduced by the approximation are acceptable in robotics applications". Could
the authors please discuss the approximations that they mean here? Is this
limited to the author's explanation of MuJoCo regularization, or do the authors
claim to explain other artififacts as well?}

The particular approximation we are talking about are the convex approximations
to the contact problem. The modeling of contact requires the solution of
challenging Non-Linear Complementarity Problems (NCP), which are non-convex.
Therefore, any convex formulation of contact is an approximation of reality.
Therefore, we do not refer in particular to MuJoCo, but any solver that uses
this approximation (we mention Chrono, MuJoCo and Siconos in Section I.B).
To address this question, we updated the text to say ``convex approximation"
explicitly and ``non-convex NCP" also explicitly, so that the approximation
and the original problem are concentrated. We highlighted the change in the
text.
