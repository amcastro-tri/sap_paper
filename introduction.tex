% The very first letter is a 2 line initial drop letter followed by the rest of
% the first word in caps.
%
% form to use if the first word consists of a single letter:
% \IEEEPARstart{A}{demo} file is ....
%
% form to use if you need the single drop letter followed by normal text
% (unknown if ever used by the IEEE): \IEEEPARstart{A}{}demo file is ....
%
% Some journals put the first two words in caps: \IEEEPARstart{T}{his demo} file
% is ....

\section{Introduction}
\label{sec:introduction}

\CyanHighlight{\IEEEPARstart{I}{ntro} paragraph stating why sim and modeling
with contact is important for robotics planning and control plus some
sim-to-real bullshit.}

Rigid body dynamics with frictional contact is complicated by the non-smooth
nature of the solutions. It is well known \cite{bib:baraff1993issues} that rigid
contact when combined with the Coulomb model of friction can lead to paradoxical
configurations for which solutions in terms of accelerations and reaction forces
do not exist. These phenomena are known as Painlev\'e paradoxes
\cite{bib:hogan2017regularization}. Theory resolves these paradoxes by allowing
discrete velocity jumps and impulsive forces, formally casting the problem as a
differential variational inequality \cite{bib:pang2008differential}. In practice
event based approaches can resolve impulsive transitions \cite{bib:haug1986},
though it is not clear how to detect these events even for simple one degree of
freedom systems \cite{bib:hogan2017regularization}.

Nevertheless, the problem can be solved in a weaker formulation at the velocity
level using a time-stepping scheme where impulses (integral of the forces over a
give time step) are the unknowns at each time step
\cite{bib:stewart1996implicit, bib:anitescu1997}. These formulations lead in
general to a non-linear complementarity problem (NCP) and to a linear
complementarity problem (LCP) when a polyhedral approximation of the friction
cone is used. Even though LCP formulations guarantee solution existence
\cite{bib:anitescu1997, bib:stewart1998convergence}, their accurate and
efficient solution has remained difficult in practice. This has been explained
in part to the fact that these formulations are equivalent to nonconvex problems
in global optimization, which are generally NP-hard \cite{bib:Kaufman2008}.
Indeed, the popular direct methods based on Lemke's pivoting algorithm to solve
LCPs may exhibit exponential worst-case complexity \cite{bib:baraff1994fast}. As
popular as direct pivoting methods, iterative methods based on projected
Gauss-Seidel (PGS) \cite{bib:duriez2006_realistic_haptic_rendering, bib:bullet}
have also shown exponentially slow convergence \cite{bib:erleben2007velocity}.

\RedHighlight{Careful not to say twice what we talk about in Section
\ref{sec:previous_work}. See if worth merging or how to consolidate these two.}

To improve computational tractability, Anitescu introduces a \textit{convex
relaxation} of the contact problem \cite{bib:anitescu2006}. This relaxation is a
convex approximation with proven convergence to the solution of a measure
differential inclusion as the time step goes to zero. The convex approximation
introduces a \emph{gliding} artifact for sliding contacts at a distance $\phi$
proportional to the time step size $\delta t$ and to the sliding velocity
$\Vert\vf{v}_t\Vert$ \cite{bib:mazhar2014}, i.e. $\phi\sim \delta
t\Vert\vf{v}_t\Vert$. Therefore the approximation is exact for sticking contact
and it can be sufficiently accurate for robotics applications for which the
product $\delta t\Vert\vf{v}_t\Vert$ can be neglected. Todorov
\cite{bib:todorov2014} introduces regularization into Anitescu's formulation in
order to write a strictly convex formulation with a unique solution. In his
work, regularization is used to introduce \emph{numerical compliance} as a means
of a Baumgarte-like stabilization and avoid constraints drift. As a side effect, the regularized formulation can lead to a noticeable non-zero slip velocity even during stiction \cite{bib:simbenchmark}.

Even though these formulations introduce a tractable approximation of frictional
contact, somehow they haven't become a popular solution approach in practice.
Sofware such as ODE \cite{bib:ode}, Dart \cite{bib:dart} and Vortex
\cite{bib:vortex} use a polyhedral approximation of the friction cone leading to
an LCP formulation. Algoryx \cite{bib:algoryx} uses a \emph{split solver},
similar to one iteration of the staggered projections method
\cite{bib:Kaufman2008}. Drake \cite{bib:drake} models compliant contact with
regularized friction and solves the underlyaing equations with its transition
aware solver TAMSI \cite{bib:castro2020}. The multi-physics simulation package
Chrono \cite{bib:hrono2016} implements a variant of the PGS method for solving
Anitescu's convex formulation \cite{bib:tasora2011}. This method is specially
targeted to the simulation of very large scale systems as those found in
granular flow. Even though some convergence guarantees are provided in
\cite{bib:anitescu2010}, the solver exhibits low convergences rates. This is
expected for such first order method. To the knowledge of the authors, Mujoco
\cite{bib:mujoco} is the only software targeted to robotics that implements a
second order Newton solver for the convex approximation of contact. However
underlying technology is proprietary and implementation details are not known in
the community.

Summarizing, after more than 15 years after the introduction of these convex
approximations, robust algorithms for their solution are lacking. It is not even
clear in the community if these formulations present a real advantage when
compared to more traditional approaches and whether the artifacts introduced by
the approximation are appropriate for robotics applications. It is the purpose
of this work to provide answers to these questions. We summarize our contributions as follows:
\begin{itemize}
	\item We build on Todorov's work \cite{bib:todorov2014} to write compact
	analytical expressions of the impulses that provide a clear physical
	interpretation of the convex formulation.
	\item We show how to use these expressions to incorporate the modeling of
	physical compliance and even complex models of \RedHighlight{compliant
	surface patches. [Reference to arxiv version]}. This is different from
	\cite{bib:todorov2014} where regularization is used as a Baumgarte-like
	stabilization.
	\item Our clear analogy with compliant contact allow us to succinctly
	describe the artifacts introduced by the convex approximation of contact.
	\item We present a discrete time stepping approach based on the
	$\theta\text{-method}$. This includes the popular symplectic Euler and the
	implicit midpoint rule. We demonstrate the midpoint rule can achieve second
	order accuracy even in problems with frictional contact.
	\item We write a primal formulation of compliant contact written in terms of
	velocities, in contrast to the dual formulations in terms of impulses
	introduced by Anitescu and Todorov.
	\item We develop our Semi-Analytical Primal solver (SAP) which eliminates
the contact constraints analytically to write an unconstrained convex
formulation. We provide thorough details for its practical implementation.
	\item We find that, unlike formulations on impulses, SAP warms starts effectively using velocities from the previous time step. 
	\item We evaluate the accuracy, robustness and performance of SAP against available commercial and open-source solvers.
	\item We show how a judicious parameterization of regularization allows for a tight resolution of stiction without sacrificing performance. This is critical for the simulation of demanding robotics tasks such as manipulation.
	\item Our method is implemented in the open-source robotics toolkit Drake \cite{bib:drake}.
\end{itemize}

\CyanHighlight{Paragraph clearly stating our contributions. Probably bullets to
make it very clear?}

\CyanHighlight{Paragraph on outline of this work.}
