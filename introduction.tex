% The very first letter is a 2 line initial drop letter followed by the rest of
% the first word in caps.
%
% form to use if the first word consists of a single letter:
% \IEEEPARstart{A}{demo} file is ....
%
% form to use if you need the single drop letter followed by normal text
% (unknown if ever used by the IEEE): \IEEEPARstart{A}{}demo file is ....
%
% Some journals put the first two words in caps: \IEEEPARstart{T}{his demo} file
% is ....

\section{Introduction}
\label{sec:introduction}

\CyanHighlight{\IEEEPARstart{I}{ntro} paragraph stating why sim and modeling
with contact is important for robotics planning and control plus some
sim-to-real bullshit.}

Rigid body dynamics with frictional contact is complicated by the non-smooth
nature of the solutions. It is well known \cite{bib:baraff1993issues} that rigid
contact when combined with the Coulomb model of friction can lead to paradoxical
configurations for which solutions in terms of accelerations and reaction forces
do not exist. These phenomena are known as Painlev\'e paradoxes
\cite{bib:hogan2017regularization}. Theory resolves these paradoxes by allowing
discrete velocity jumps and impulsive forces, formally casting the problem as a
differential variational inequality \cite{bib:pang2008differential}. In practice
event based approaches can resolve impulsive transitions \cite{bib:haug1986},
though it is not clear how to detect these events even for simple one degree of
freedom systems \cite{bib:hogan2017regularization}.

Nevertheless, the problem can be solved in a weaker formulation at the velocity
level using a time-stepping scheme where impulses (integral of the forces over a
give time step) are the unknowns at each time step
\cite{bib:stewart1996implicit, bib:anitescu1997}. These formulations lead in
general to a non-linear complementarity problem (NCP) and to a linear
complementarity problem (LCP) when a polyhedral approximation of the friction
cone is used. Even though LCP formulations guarantee solution existence
\cite{bib:anitescu1997, bib:stewart1998convergence}, their accurate and
efficient solution has remained difficult in practice. This has been explained
in part to the fact that these formulations are equivalent to nonconvex problems
in global optimization, which are generally NP-hard \cite{bib:Kaufman2008}.
Indeed, the popular direct methods based on Lemke's pivoting algorithm to solve
LCPs may exhibit exponential worst-case complexity \cite{bib:baraff1994fast}. As
popular as direct pivoting methods, iterative methods based on projected
Gauss-Seidel (PGS) \cite{bib:duriez2006_realistic_haptic_rendering, bib:bullet}
have also shown exponentially slow convergence \cite{bib:erleben2007velocity}.
\RedHighlight{TODO: this seems good to me. Consider saying something about
optimization based methods as those by Kaufman. But not knowing of others, it
might just be ok to stop right here. The point that NCPs/LCPs are hard to solve
in practice has been made.}

\RedHighlight{Careful not to say twice what we talk about in Section
\ref{sec:previous_work}. See if worth merging or how to consolidate these two.}

To improve computational tractability, Anitescu introduces a \textit{convex
relaxation} of the contact problem \cite{bib:anitescu2006}. This relaxation is a
convex approximation with proven convergence to the solution of a measure
differential inclusion as the time step goes to zero. The convex approximation
introduces a \emph{gliding} artifact for sliding contacts at a distance $\phi$
proportional to the time step size $\delta t$ and to the sliding velocity
$\Vert\vf{v}_t\Vert$ \cite{bib:mazhar2014}, i.e. $\phi\sim \delta
t\Vert\vf{v}_t\Vert$. Therefore the approximation is exact for sticking contact
and it can be sufficiently accurate for robotics applications for which the
product $\delta t\Vert\vf{v}_t\Vert$ can be neglected. Todorov
\cite{bib:todorov2014} introduces regularization into Anitescu's formulation in
order to write a strictly convex formulation with a unique solution. In his
work, regularization is used to introduce \emph{numerical compliance} as a means
of a Baumgarte-like stabilization and avoid constraints drift.

Even though these formulations introduce a tractable approximation of frictional
contact, somehow they haven't become a popular solution approach in practice.
Sofware such as ODE \cite{bib:ode}, Dart \cite{bib:dart} and Vortex
\cite{bib:vortex} use a polyhedral approximation of the friction cone leading to
an LCP formulation. Algoryx \cite{bib:algoryx} uses a \emph{split solver},
similar to one iteration of the staggered projections method
\cite{bib:Kaufman2008}. Drake \cite{bib:drake} models compliant contact with
regularized friction and solves the underlyaing equations with its transition
aware solver TAMSI \cite{bib:castro2020}. The multi-physics simulation package
Chrono \cite{bib:hrono2016} implements a variant of the PGS method for solving
Anitescu's formulation \cite{bib:tasora2011}. This method is specially targeted
to the simulation of very large scale systems as those found in granular flow.
Even though some convergence guarantees are provided in \cite{bib:anitescu2010},
the solver exhibits low convergences rates. This is expected for such first
order method. To the knowledge of the authors, Mujoco \cite{bib:mujoco} is the
only software targeted to robotics that implements a second order Newton solver
for the convex approximation of contact. However  underlying technology is
proprietary and implementation details are not known in the community.

\CyanHighlight{State
here or below, how after 15 years after Anitescu's work, there is no freely
available knowledge on how to solve this problem effectively.}

\RedHighlight{Probably a small paragraph here on convex optimization methods and
how for simulation there is the need for a methods that warms starts
effectively? Ask Frank for help.}

\CyanHighlight{Paragraph clearly stating our contributions. Probably bullets to
make it very clear?}

\CyanHighlight{Paragraph on outline of this work.}


\section{Introduction (Old)}
\RedHighlight{TODO: Rewrite for paper.}

\IEEEPARstart{A}{Anitescu}'s convex relaxation of contact
\cite{bib:anitescu2006} has been in existence for 14 years. However to my
knowledge there are no simulation/trajectory optimization codes out there that
can exploit this formulation. In other words, the formulation is theoretically
beautiful, but there are no practical solvers out there for it. The best
reported solver for this formulation, later on presented by Anitescu in
\cite{bib:anitescu2010, bib:tasora2011}, consists of a Projected Gauss-Seidel
(PGS) iteration which is very well known not to converge in practice and it is
usually stoped at a fixed number of iterations with an unknown amount of
numerical error. Therefore, it is unclear even today whether Anitescu's
formulation presents any advantage over other non-convex solution strategies. In
\cite{bib:todorov2014} Todorov mentions a so called \textit{generalized}
projected Gauss-Seidel (though the details were never published), which
generalizes PGS to deal with the true quadratic friction cone, anisotropy,
torsional and rolling friction.

The objectives of this reasearch are:
\begin{enumerate}
	\item To develop a \textit{practical} solution strategy that is robust and
	has good scalability to number of bodies and contacts.
	\item To extend the formulation to enable the simulation of soft deformable
	bodies with contact.
	\item To properly quantify the \textit{unphysical artifacts} introduced by
	the convex relaxation of the original physics.
	\item To answer the questions ``does the Convex formulation provide any
	significant advantage over other methods?'', ``are the unphysical artifacts
	introduced worth the price?''
	\item To provide an open source implementation of this research that
	outperforms existing methods.
\end{enumerate}

\section{Other Papers Worth Citing}
\RedHighlight{Notes to help writing the intro and suplement other sections
better.}

\begin{enumerate}
	\item Acary \cite{bib:acary2011formulation} also uses the same convex
	formulation. It might be worth mentioning differences, contributions and
	specific field of engineering.
	\item Kaufman's thesis on staggered projections
	\cite{bib:kaufman2009coupled} states this interesting observation on LCP's:
	``It has been recently noted, however, that direct LCP solvers do not, in
	practice, scale. They are not, in fact, currently able to return solutions
	for non-trivial frictionally contacting problems beyond relatively
	small-scale examples [Anitescu and Hart 2004; Erleben 2007]. In Chapter 5 we
	will discuss these difficulties further and investigate the reasons why
	these methods often fail.'' This is backed up on the works of Anitescu and
	Hart 2004; Erleben 2007
	\cite{bib:anitescu2004fixed,bib:erleben2007velocity}.
	\item Anitescu \cite{bib:anitescu2010} also talks about how LCPs do not work
	well in practice: ``However, these methods may exhibit an exponential
	worst-case complexity [9]. Our experience shows that, in spite of deep opti-
	mizations [40], simplex methods still cannot practically handle multibody
	systems with more than one hundred colliding bodies.''
\end{enumerate}

\section{Novel Contributions}
\RedHighlight{TODO: Rewrite for paper.}

Since we build on previous work \cite{bib:anitescu2006,
bib:anitescu2010,bib:todorov2014}, it is worth summarizing our novel
contributions:
\begin{itemize}
	\item Clear algebraic expressions for the \textit{inverse dynamics} of
	contact are provided.
	\item We show how to use these expressions do model true compliant contact.
	This is different from \cite{bib:todorov2014} where regularization is used
	as a Baumgarte-like stabilization.
	\item The analasis of the analytical inverse dynamics expressions here
	provided allows to make a clear analogy with compliant contact.
	\item Our clear analogy with compliant contact allow us to succinctly
	describe the artifacts introduced by the convex approximation of contact.
	\item We write a primal formulation of compliant contact written in terms of
	velocities, in contrast to its dual in terms of impulses.
	\item We show how the primal formulation when combined with the analytical
	 inverse dynamics leads to an unconstrained convex optimization problem.
	\item We develop a custom solver for this unconstrained formulation and
	provide thorough details for a practical implementation.
	\item We conclude with a number of demonstrations illustrating the
	effectiveness of our methodology and provide future research directions.
\end{itemize}
