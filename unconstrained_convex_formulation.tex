\section{An Unconstrained Convex Formulation}
\label{sec:unconstrained_convex_formulation}

From Theorem \ref{th:primal_dual_equivalence} we know that $\bsigma = \bgamma$.
Therefore we can use the analytical inverse dynamics from Section
\ref{sec:analytical_inverse_dynamics} to eliminate $\bsigma$ from the primal
formulation and obtain an unconstrained convex formulation in terms of
generalized velocities $\mf{v}$ only.

We then substitute $\bsigma=\bgamma=P_\mathcal{F}(\mf{y})$ from Eq.
\ref{eq:analytical_y_projection} into Eq. (\ref{eq:primal_regularized}) to
obtain our unconstrained convex formulation in velocities only
\begin{eqnarray}
	\min_{\mf{v}} \ell_p(\mf{v}) =
	\frac{1}{2}(\mf{v}-\mf{v}^*)^T\mf{A}(\mf{v}-\mf{v}^*) +
	\ell_R(\mf{v})
	\label{eq:primal_unconstrained}
\end{eqnarray}
with the regularizer
\begin{equation}
	\ell_R(\mf{v}) = \frac{1}{2}\Vert P_\mathcal{F}(\mf{y}(\mf{v}))\Vert_R^2
\end{equation}

In order for the velocities solution of Eq. (\ref{eq:primal_unconstrained}) to
be a solution of the original problem stated in Eq.
(\ref{eq:primal_regularized}), they must also satisfy the conic constraint
$\mf{g}\in\mathcal{F}^*$. We stablish this result in the following
\begin{lemma}
    velocites solution to Eq. (\ref{eq:primal_unconstrained}) satisfy the conic
    constraint $\mf{g}\in\mathcal{F}^*$ when the impulses are given by
    $\bsigma=\bgamma=P_\mathcal{F}(\mf{y})$.
    \label{lemma:conic_constraints_are_satisfied_analytically}
\end{lemma}
\begin{IEEEproof}
    The proof follows immediately from Moreau's decomposition theorem. That is,
    with $\mf{v}_c - \hat{\mf{v}}\in\mathbb{R}^{3n_c}$ and $\bsigma$ the result
    from the projection into $\mathcal{F}$ using the $\mf{R}$ norm, the linear
    combination $\mf{v}_c - \hat{\mf{v}} + \mf{R}\bsigma$ must be in
    $\mathcal{F}^*$.
\end{IEEEproof}

Therefore we can state the following
\begin{theorem}
    Velocities $\mf{v}$ solution to Eq. (\ref{eq:primal_unconstrained}) and
    $\bsigma=P_\mathcal{F}(\mf{y})$ from the analytical solution in Eq.
    (\ref{eq:analytical_y_projection}) are solution to the original primal
    formulation stated in Eq. (\ref{eq:primal_regularized}).
\end{theorem}
\begin{IEEEproof}
    Theorem \ref{th:primal_dual_equivalence} states that $\bsigma=\bgamma$.
    Given known primal-optimal velocities, $\bgamma$ is given by the same
    analytical inverse dynamics used in the unconstrained formulation in Eq.
    (\ref{eq:primal_unconstrained}).
    In addition, these velocities and the analytical impulses satisfy the cone
    constraints by Lemma \ref{lemma:conic_constraints_are_satisfied_analytically}.
\end{IEEEproof}

This new formulation forms the foundation of the novel SAP solver developed in
this work, Section \ref{sec:sap_solver}.

