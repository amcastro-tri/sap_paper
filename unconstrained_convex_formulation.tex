\section{An Unconstrained Convex Formulation}
\label{sec:unconstrained_convex_formulation}

We use the analytical inverse dynamics to write an unconstrained convex
formulation in terms of velocities only
\begin{eqnarray}
	\min_{\mf{v}} \ell_p(\mf{v}) = \frac{1}{2}\Vert\mf{v}-\mf{v}^*\Vert_{A}^2 +
	\frac{1}{2}\Vert P_\mathcal{F}(\mf{y}(\mf{v}))\Vert_R^2
	\label{eq:primal_unconstrained}
\end{eqnarray}
where, as with other quantities, we form $\mf{y}$ by stacking together each
$\mf{y}_i$ for all contact pairs together. Given the separable structure of the
constraints, projection $P_{\mathcal{F}}(\mf{y})$ onto $\mathcal{F} :=
\mathcal{F}_1 \times F_2 \times \cdots \times \mathcal{F}_{n_c}$ in the norm
defined by $\mf{R}$ is formed by stacking together the individual projections
$P_{\mathcal{F}_i}(\vf{y}_i)$ from Eq. (\ref{eq:y_projection}).

The unconstrained formulation in Eq. (\ref{eq:primal_unconstrained}) includes
the same cost in velocities as the primal formulation from Eq.
(\ref{eq:primal_regularized}). However, the conic constraint $\mf{g}\in
\mathcal{F}^*$ in Eq. (\ref{eq:primal_regularized}) has been replaced by a cost
term on the analytical inverse dynamics. We state the main result of this
section in the following result, proved in Appendix \ref{app:unconstrained_formulation_equivalance}.
\begin{theorem}
    The pair $\{\mf{v},\bsigma\}$, with velocities $\mf{v}$ solution to the
    unconstrained formulation in Eq. (\ref{eq:primal_unconstrained}) and
    $\bsigma=P_\mathcal{F}(\mf{y}(\mf{v}))$, is primal optimal of the primal
    formulation in Eq. (\ref{eq:primal_regularized}).
    \label{th:unconstrained_formulation_equivalance}
\end{theorem}

Section \ref{sec:sap_solver} presents our novel SAP \CyanHighlight{TODO: make
sure SAP is defined before} solver specifically designed to solve the
unconstrained formulation in Eq. (\ref{eq:primal_unconstrained}).
