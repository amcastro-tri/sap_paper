% Dummy comment for Reviewable.

\subsection{Discrete Model}\label{sec:discrete_time_formulation}
We base our time-stepping scheme on the $\theta\text{-method}$ \cite[\S
II.7]{bib:hairer2008solving}. We discretize time into intervals of fixed size
$\delta t$ and seek to advance the state of the system from time $t^n$ to the
next step at $t^{n+1} = t^n + \delta t$. In the $\theta\text{-method}$,
variables are evaluated at intermediate time steps $t^\theta = \theta
t^{n+1}+(1-\theta)t^{n}$, with $\theta \in [0, 1]$. \reviewquestion{R1-Q6}{We define \emph{mid-step
quantities} $\mf{q}^{\theta}$, $\mf{v}^{\theta}$, and
$\mf{v}^{\theta_{vq}}$ in accordance with the standard $\theta\text{-method}$
using scalar parameters $\theta$ and $\theta_{vq}$
\begin{align}
	\mf{q}^{\theta} &\defeq \theta\mf{q} + (1-\theta)\mf{q}_0,\nonumber\\
	\mf{v}^{\theta} &\defeq \theta\mf{v} + (1-\theta)\mf{v}_0,\nonumber\\
	\mf{v}^{\theta_{vq}} &\defeq \theta_{vq}\mf{v} + (1-\theta_{vq})\mf{v}_0,
	\label{eq:theta_method}
\end{align}}
where, to simplify notation, we use the naught subscript to denote quantities
evaluated at the previous time step $t^n$ while no additional subscript is used
for quantities at the next time step $t^{n+1}$. Using these definitions we write
the following time stepping scheme where the unknowns are the next time step
generalized velocities $\mf{v}\in\mathbb{R}^{n_v}$, impulses
$\bgamma\in\mathbb{R}^{3n_c}$ and multipliers ${\bm\lambda}\in\mathbb{R}^{n_c}$
\begin{flalign}
    % Momentum equation.
	&\mf{M}(\mf{q}^{\theta}(\mf{v}))(\mf{v}-\mf{v}_0) =\nonumber\\
	&\qquad\delta
	t\,\mf{k}(\mf{q}^{\theta}(\mf{v}),\mf{v}^{\theta}(\mf{v})) +
	\mf{J}(\mf{q}_0)^T\mf{\bgamma}, \label{eq:scheme_momentum}\\
    % Non-penetration condition.
    &0 \le \phi_i(\mf{q}(\mf{v})) + \tau_{d,i}\,v_{n,i}(\mf{q}, \mf{v}) + \frac{c_i}{\delta t}\gamma_{n,i}\nonumber\\
    &\qquad\perp \gamma_{n,i} \ge 0, \quad\qquad\qquad\qquad i\in\mathscr{C}(\mf{q}_0)
    \label{eq:scheme_nonpenetration}\\
    % Maximum dissipation principle.
    &\mu_i\gamma_{n,i}\vf{v}_{t,i}(\mf{q}, \mf{v}) + \lambda_i \bgamma_{t,i} = \vf{0},
    \!\qquad i\in\mathscr{C}(\mf{q}_0)
    \label{eq:scheme_mdp_multiplier}\\
    &0\le \lambda_i \perp \mu_i\gamma_{n,i}-\Vert\bgamma_{t,i}\Vert \ge 0
    , \!\!\qquad i\in\mathscr{C}(\mf{q}_0)
    \label{eq:scheme_mdp_cone}\\
    % Positions update.
    &\dot{\mf{q}}^{\theta_{vq}}(\mf{v}) = \mf{N}(\mf{q}^{\theta}(\mf{v}))\mf{v}^{\theta_{vq}}(\mf{v}),\\    
    &\mf{q}(\mf{v}) = \mf{q}_0 + \delta t \dot{\mf{q}}^{\theta_{vq}}(\mf{v}),
    \label{eq:scheme_q_update}
\end{flalign}
where $\mf{M}(\mf{q})\in\mathbb{R}^{n_v\times n_v}$ is the mass matrix and
$\mf{k}(\mf{q},\mf{v})\in\mathbb{R}^{n_v}$ models external forces such as
gravity, gyroscopic terms and other smooth generalized forces such as those
arising from springs and dampers.

\reviewquestion{R1-Q6}{This scheme includes some of the most popular schemes for
forward dynamics:
\begin{itemize}
	\item Explicit Euler with $\theta=\theta_{vq} = 0$,
	\item Symplectic Euler with $\theta = 0$ and $\theta_{vq}=1$,
	\item Implicit Euler with $\theta = \theta_{vq}= 1$, and
	\item Symplectic midpoint rule, which is second order, with $\theta =
\theta_{vq}= 1/2$.
\end{itemize}

Notice that in our version of the $\theta\text{-method}$, the additional
parameter $\theta_{vq}$ allows us to also incorporate the popular Symplectic
Euler scheme.}

When only conservative forces are considered in
$\mf{k}(\mf{q},\mf{v})$, the symplectic Euler scheme keeps the total mechanical
energy bounded while exact energy conservations can be attained with the second
order midpoint rule, see results in Section \ref{sec:spring_cylinder}. In
addition, stability analysis in \cite{bib:anitescu2002,bib:potra2006linearly}
shows that these implicit schemes are appropriate for the integration of stiff
forces arising in multibody applications such as springs and dampers.
