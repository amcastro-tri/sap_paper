The Lagrangian of the primal formulation in Eq. (\ref{eq:primal_regularized}) is
\begin{equation}
    \mathcal{L}(\mf{v},\bsigma,\vf{\gamma}) = 
\frac{1}{2}\Vert\mf{v}-\mf{v}^*\Vert_A^2 + \frac{1}{2} \Vert\bsigma\Vert_{R}^2 - \vf{\gamma}^T\mf{g},
\end{equation}
with $\vf{\gamma}\in\mathcal{F}$ the dual variable to enforce the constraint
$\vf{g}\in \mathcal{F}^*$. Minimizing the Lagrangian jointly in variables $\mf{v}$ and $\bsigma$ leads
to the optimality conditions
\begin{subequations}\label{eq:primal_optimality_conditions}
\begin{align}
    \mf{A}(\mf{v}-\mf{v}^*) &= \mf{J}^T\vf{\gamma} \label{eq:momentum_optimality}\\
    \vf{\sigma} &= \vf{\gamma}.  \label{eq:sigma_equal_gamma}
\end{align}
\end{subequations}
The optimality condition \eqref{eq:momentum_optimality} reveals that the
multipliers $\bgamma$ are indeed the contact impulses, and we recover the
balance of momentum. The optimality condition \eqref{eq:sigma_equal_gamma}
allows us to eliminate $\vf{\sigma}$. We then substitute these results back into
the Lagrangian to recover the dual in
\eqref{eq:dual_regularized}
\begin{align*}
    \min_{\bgamma\in \mathcal{F}} \ell_d(\bgamma) =
    \frac{1}{2}\bgamma^T(\mathbf{W}+\mathbf{R})\bgamma + {\bm r}^T
    \bgamma,
\end{align*}
where, in contrast to previous work, our Delassus operator
$\mf{W}=\mf{J}\mf{A}^{-1}\mf{J}^T$ now also contains the contribution of
internal force elements (through Eq. (\ref{eq:expression_for_A})) and
$\mf{r}=\mf{v}_c^*-\hat{\mf{v}}_c$ with
$\mf{v}_c^*=\mf{J}\mf{v}^*$.\hfill\IEEEQED
