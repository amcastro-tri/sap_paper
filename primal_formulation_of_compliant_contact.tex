\section{A Primal Formulation of Compliant Contact}
\label{sec:primal_formulation}

In this section we give a convex program that augments the balance of momentum
stated in Eq. (\ref{eq:momentum_linearized}) so that contact impulses model
Coulomb friction and satisfy the principle of maximum dissipation.
We call this convex program our \emph{primal formulation}, since as stated in Theorem \ref{th:primal_dual},
its dual is precisely the formulation stated in Eq.
(\ref{eq:dual_regularized}). We will see in Section
\ref{sec:unconstrained_convex_formulation} that with this primal formulation,
we can eliminate the constraints analytically to write an unconstrained convex
formulation of the same problem.

We introduce a new decision variable $\vf{\sigma}\in\mathbb{R}^{3n_c}$ and
set up our primal formulation of compliant contact as the following convex
optimization problem
\begin{equation}
	\begin{aligned}
	\min_{\mf{v},\bsigma} \quad & \ell_p(\mf{v},\bsigma) =
	\frac{1}{2}\Vert\mf{v}-\mf{v}^*\Vert_{A}^2 +
	\frac{1}{2} \Vert\bsigma\Vert_{R}^2\\
	\textrm{s.t.} \quad & \mf{g} = (\mf{J}\mf{v}-\hat{\mf{v}}_c + \mf{R}\bsigma) \in \mathcal{F}^*\\
	\end{aligned}
	\label{eq:primal_regularized}
\end{equation}
where $\Vert\mf{z}\Vert_X^2=\mf{z}^T\mf{X}\mf{z}$ with $\mf{X}\succ 0$ and
$\mathcal{F^*}= \mathcal{F}^*_1 \times \mathcal{F}^*_2 \times \cdots \times
\mathcal{F}^*_{n_c}$ is the \emph{dual cone} of the convex cone $\mathcal{F}$.
The positive diagonal matrix $\mf{R}\in\mathbb{R}^{3n_c\times 3n_c}$ and the
vector of stabilization velocities $\hat{\mf{v}}_c$ encode the problem data
needed to model compliant contact. We will establish a very clear physical
meaning for these terms when we provide analytical expressions for the impulses
in Section \ref{sec:physical_intuition}. In the limit of rigid contact
when the regularization $\mf{R}$ is zero, our primal formulation reduces to that
presented in \cite{bib:mazhar2014}.

We conclude this section with the following theorem, proved in Appendix \ref{app:primal_dual_proof}.

\begin{theorem}\label{th:primal_dual}
The dual of \eqref{eq:primal_regularized} is given by 
\eqref{eq:dual_regularized}. Moreover, when $\{\mf{v},\bsigma\}$ is primal optimal and
$\bgamma$ is dual optimal, $\bsigma = \bgamma$.
\end{theorem}

An important outcome from the proof of Theorem \ref{app:primal_dual_proof} is
that the optimality condition for the primal formulation
\eqref{eq:primal_regularized} corresponds to the balance of momentum, Eq.
\eqref{eq:momentum_linearized}. That is, the convex program
\eqref{eq:primal_regularized} encodes both balance of momentum and contact
constraints.