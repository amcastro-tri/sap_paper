\section{Associate Editor}
\label{sec:associate_editor}

\textcolor{blue}{Three Reviewers evaluated the submitted paper. Their comments
are reported and should be carefully followed. In particular, the Reviewers
highlighted several criticisms.}
\textcolor{blue}{\begin{itemize}
    \item Linearization effects should be better highlighted (Reviewer 1).
\end{itemize}}
Linearization of the equations of motion is a very common approximation in many
other time stepping schemes for multibody dynamics in the literature, specially
so if contact is involved. However, the details might be elusive if not properly
mentioned. Therefore we do agree with this review, these approximations must be
mentioned explicitly.

Reviewer 1 comments on linearization effects in questions R1-Q1, R1-Q2 and
R1-Q3. We provided specific answers to each of these questions in this document
and updated the manuscript accordingly. 

We explicitly state our linear approximations in the newly introduced
\emph{Limitations} section in the updated manuscript.

\textcolor{blue}{\begin{itemize}
    \item It seems that the approach has an implicitly defined constraint,
\end{itemize}}
Constraints in this formulation are eliminated using analytic formulae that we
provide in this work. We provided more details in the answer to R1-Q7 in this
document.

\textcolor{blue}{which contradicts the claim of an unconstrained problem. If
this impression is confirmed, then the global convergence of the method becomes
unclear (Reviewer 1).}

We address this point in answer to R1-Q4, with mention specific theorems and
results in our work. We highlighted updates in the manuscript accordingly.

\textcolor{blue}{
\begin{itemize}
    \item A more in-depth analysis of the matrices K, D, and H should be
    carried out. Can they be non-symmetric? (Reviewer 4)
\end{itemize}}

This is an important aspect of our work. While we do not impose any restriction
on the gradient $\partial \mf{m}/\partial \mf{v}$ (with the momentum residual
$\mf{m}$ defined in Eq. 14), we do require its approximation $\mf{A}$ to be SPD.
We address this question in detail in R4-Q3 and in the updated manuscript.


\textcolor{blue}{
\begin{itemize}
    \item Authors should clearly state the limitation of the approach. This
regards scalability (Reviewer 4), objects convexity (Reviewer 8), change in
contact modes during the task( Reviewer 8), and possible others. \end{itemize}}

Scalability is addressed in R4-Q7, objects convexity in R8-Q1, and changes in
contact modes in R8-Q3, along specific updates to the manuscript.

In addition, we added Section VIII discussing these and other limitations we
identified with our approach.

\vspace{5mm}
\textcolor{blue}{After a careful reading of the paper, this Associate Editor
agrees with all the points raised by the Reviewers.}

We agree with the points raised as well. We believe the updated manuscript is an
improvement over the original version thanks to the reviewers' comments.

\vspace{5mm}
\textcolor{blue}{In addition, this AE has the following further comments.}
\textcolor{blue}{
\begin{itemize}
    \item[AE-Q1] As also highlighted by Reviewer 1, the current paper's outline
confuses the reader and makes the reading flow difficult. This AE suggests
deeply revising the organization of the contents. One solution is to avoid
fragmenting the content in so many different sections. Authors should organize
the same focus in one or two bigger sections and exploit subsections to split
the related content. For instance, this AE believes that Sections V, VI, VII,
and IX may be unified. Instead, it is not clear why Sections II, III, and IV
have been split in such a way, also because the same concepts are often repeated
(as the fact that "the proposed approach does not approximate the friction cone
but [...]").\end{itemize}}

We do realize the original organization of the contents was far from optimal. We
are glad the reviewers agreed on the need for this change. We reorganized the
updated manuscript in order to make the contents flow more linearly, group
similar concepts together and avoid repetition. In the new manuscript Section II
introduces the mathematical model of multibody dynamics with frictional contact,
introduces notation and establishes the non-linear complementarity problem (NCP)
that must be solved in the most general case. Section III now is entirely
focused to the convex approximation of this NCP formulation, effectively
grouping together concepts previously scattered across different sections.
Section IV now follows naturally, describing our proposed SAP strategy to solve
the resulting unconstrained optimization problem. Finally, everything related to
the physical interpretation and modeling parameters of the convex approximation
is condensed in Section V.

\vspace{5mm}
\textcolor{blue}{AE-Q2: On the other hand, the state of the art can be removed from
Section I, and a dedicated (sub)section may be created. Novelties (and
limitations of the approach as said above) should be addressed in separated
subsections. Therefore, a considerable re-organization of the contents is
suggested.}

In the updated manuscript Section I.B summarizes available software that uses a
convex approximation of contact, Section I.C states our contributions and
Section VIII explicitly states limitations of our approach.

\textcolor{blue}{
\begin{itemize}
    \item[AE-Q3] Authors performed a good state of the art within the Introduction,
    mentioning much software such as ODE, Dart, Vortex, Mujoco, and Chrono. The
    authors also provide differences between the cited software and the one
    proposed in the reviewed paper. However, RaiSim [AE1,AE2] is
    missing.\end{itemize}}

Thank you for the reference, we added it to the updated manuscript.

\textcolor{blue}{
\begin{itemize}
    \item[AE-Q4] What is the "gap function" in section II?\end{itemize}}
    
In the context of multibody dynamics with contact \emph{gap function} often
refers to the \emph{signed distance function}, see for instance
\cite{bib:negrut2018posing, bib:duriez2005realistic,
bib:laursen2003computational}. We do realize however that \emph{signed distance}
is the more common term in the robotics community and we adopted this
terminology instead. Section II.A has been updated and references are provided.

\textcolor{blue}{\begin{itemize}
\item[AE-Q5] Maybe, a $\delta t$ term is missing in the last term of Eq. (2).
\end{itemize}} 

\textbf{Please note:} in the updated manuscript the balance of momentum in the
previous Eq. (2) is now stated in Eq. (7).

The reason $\delta t$ does not appear in the last term of Eq. (7) is because
$\bgamma$ denote impulses, the integral (in this case over one time step) of the
forces. Mean forces over a time step are recovered dividing impulses by $\delta
t$. This shows in Eq. (2) for the modeling of compliance. We updated the
manuscript to explicitly state this.

\textcolor{blue}{\begin{itemize}
\item[AE-Q6] In Section II, the non-penetration constraint equation has a non-explained
symbolism. Please, clarify the expressions with the $\perp$ symbol (see also Eq.
(4)).\end{itemize}}

Thank you, we missed this in the original manuscript. We updated the text in
Section II.B to define the $\perp$ symbol.
    
\textcolor{blue}{\begin{itemize}
\item[AE-Q7] At the beginning of Section VII, it is written that "the approach is
different from the one in [16], where regularization is not used to model
physical compliance but rather to introduce a user tunable Baumgarte-style"
stabilization to avoid constant drift." It is unclear to this AE whether this
difference is due to a different interpretation of the regularization term or it
is substantial, affecting the theoretical part.\end{itemize}} 

\textbf{Please note:} [16] refers to the work by Todorov in
\cite{bib:todorov2014}.

It is somewhat known that stabilization leads to \emph{numerical compliance}, a
fact that Todorov uses effectively in his work. However, there is a substantial
contribution here that must not be overlooked. That is, we do provide an exact
mapping between regularization and physical compliance, something that has never
been done before. This novel contribution means that:
\begin{enumerate}
    \item Regularization is no longer a \emph{tunning} parameter of the
    algorithm, but now the user can specify true physical parameters that SAP
    uses to map into the needed regularization.
    \item New models of the physics of contact, such as the hydroelastic contact
    model we use in this work
    \cite{bib:elandt2019pressure,bib:masterjohn2021discrete}, can now be
    incorporated into the formulation. This is simply impossible without the
    exact mapping between regularization and physical parameters.
\end{enumerate}

We updated text in the ``Outline and Novel Contributions'' Section I.C.

\vspace{5mm}
\textcolor{blue}{\begin{itemize}
    \item[AE1] https://raisim.com
    \item[AE2] J. Hwangbo, J. Lee, M. Hutter, "Pre-contact iteration method for
solving contact dynamics," IEEE Robotics and Automation Letters, vol. 3, n. 2,
pp. 895-902, 2018.\end{itemize}} 

